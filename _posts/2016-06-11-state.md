---
layout: post
title:  "『狀態』的概念"
date:   2016-06-11 01:25:00 +0900
author: 沙耶
categories: 
comments: true
---

若問我認為重要的程式概念為何，『狀態』肯定是不可或缺的一項。

# 何謂狀態？

我想避談『狀態機』或者『自動機』相關的內容，有興趣者可以自行查閱關鍵字。
枯燥的嚴謹定義和證明就留給教科書吧，我喜歡講本質上的精神與概念。

> 『狀態』，便是我們描述一件事物，在某個時間點下的樣子。
它可能隨著時間改變，隨著我們對它的『操作』改變。

或者說，
**『操作』就是改變事物『狀態』的動作。**

比如說，我坐在床上，左手持書，右手執杖。
『坐在床上』『左手持書』『右手執杖』就是形容『我』的『狀態』。

接下來，有隻狐娘把我撲倒。左手因此鬆開，手上的書掉了下來。
於是我的狀態變成了『倒在床上』『左手空空』『右手執杖』。
狐娘把我撲倒則是一個對我的『操作』，它改變了我的一個或一些狀態。

# 省略描述

當然，也許我身上穿著長袍，或者沒穿；也許在笑，也許在哭，也許面無表情。
這些也可以是形容我當下樣子的『狀態』，但是…

如同你在打怪時，頂多只看到怪物剩餘生命力，
並不會看到他的爪子因承受了火球攻擊而燒得焦黑，
腹部被風刃劃開了一道三公分長的傷口，鮮血潺潺流出；
或者，怪物共有四個兄弟姊妹，父母健在…等等。

**我們傾向只記錄我們關心的、在意的狀態。**

就像我們也通常不記錄手上持有的書其書名、內頁所有內容、
第87頁有一些破損、第245頁有髒污…等，何況髒污和破損連文字都很難描述。
除非這些小細節正是我們主要關心的狀態，否則通常會忽略掉。

# 簡化描述

我們傾向以『量化』來簡化狀態的描述，怪物的剩餘生命力便是一例。
它只描述了我們的攻擊，導致它有多接近死亡。
並不會因為手臂負傷而使得攻擊力下降，因出血而導致虛弱難以使力。

> 也就是說，我們簡化了『傷勢』或者『健康』這一類的詳細狀態，
將其化為離散而有限的『整數』來描述。

被簡化的狀態，則**因簡化而變得不可考，變得無從得知。**

『分級』是一種更簡化的量化。比如說，
Saber的力量有416之高，敏捷亦高達255。
而Archer的力量則只有328，敏捷則有232。

在分級後變成
Saber的力量為B等級，敏捷是C等級。
Archer的力量為C等級，敏捷為C等級。

僅管實際有些區別，卻可能被歸為相同的等級。
這也是簡化的代價之一，就是變得無法細分。
但是相對更容易歸類和描述。

事實上255或232之類的數字，也可以說是較細微的分級。
或許文字敘述，也可以說是一種對事實的簡化描述吧？

# 代號描述

在程式中，要描述事物狀態時，通常除了以『量化』來適度簡化外，
也會透過自定義『代號』來描述。

通常我們習慣以變數來儲存一個描述，但使用文字是危險且效率不佳的。
文字對相同的描述可能出現細微的差異，像是『坐著』『坐下』『坐』
因此習慣上會設置代號，以整數來替代。

- 0: 站著
- 1: 躺著
- 2: 坐著

於是，『我坐著』就會在姿勢上以整數2來儲存。

但是如此一來，判斷自己是否坐著會變成

```javascript
if (self.pos == 2)
  ....
```

並非好事。假如我今天發現，我如果把代號改成：

- 0: 站著
- 1: 坐著
- 2: 躺著

讓它有『數字越大，代表在冒險時這姿勢越危險』的特性時…
我得找出所有判斷姿勢的地方，將1改為2，2改為1，而且很可能遺漏或重覆更改。
就算想用編輯器的取代功能，也很容易改到不相干的東西。

即便不與人合作，過個十天半個月，遲至半年一年，
大概連作者也不記得2代表什麼意思了。

這時通常會出現代號的代號，使用變數、常數或enum等方式：

```javascript
var POS_STAND = 0;
var POS_SIT = 1;
var POS_LIE = 2;
```

如此一來，要更改時便容易得多。閱讀時也變得容易：

```javascript
if (self.pos == POS_SIT)
  ....
```

# 結語

整個程式就是一個大型系統，一個小型世界，
裡面不停地執行著各種『操作』，改變著內部事物的各種『狀態』。
而我們，則是此世界的主宰者，決定一切規則，掌握所有因果。

> 『狀態』隨處可見，『操作』無時無刻地在發生；
在你我能清楚感受到的地方，在沒有人知道的地方，
隨時隨地，無所不在。

世界的運作、自然的循環也是如此。
舉手投足皆操作，環顧四方皆狀態。

道理俯拾皆是，無有領域隔閡，未必離世艱澀。
或許不分文理，相輔相成，方為登峰造極之道。
